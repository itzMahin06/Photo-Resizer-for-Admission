<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Photo Resizer for Admission</title>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

<style>
    :root {
        --primary: #6366f1; /* Indigo */
        --primary-dark: #4f46e5;
        --secondary: #ec4899; /* Pink/Rose for accents */
        --bg-color: #f8fafc;
        --card-bg: #ffffff;
        --text-main: #1e293b;
        --text-muted: #64748b;
        --border: #e2e8f0;
        --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    body {
        font-family: 'Poppins', sans-serif;
        color: var(--text-main);
        background-color: var(--bg-color);
        background-image: radial-gradient(#e2e8f0 1px, transparent 1px);
        background-size: 20px 20px;
        padding-top: 80px; /* Space for fixed header */
        padding-bottom: 40px;
    }

    /* --- Header --- */
    header {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 70px;
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(226, 232, 240, 0.8);
        display: flex;
        justify-content: center; /* Centered content */
        align-items: center;
        z-index: 1000;
        transition: all 0.3s ease;
    }
    
    .brand a {
        text-decoration: none;
        display: flex;
        align-items: center;
        color: var(--primary-dark);
        font-weight: 700;
        font-size: 1.25rem;
        gap: 10px;
    }

    .brand img {
        height: 35px;
        width: 35px;
        border-radius: 50%;
        object-fit: cover;
        box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    /* --- Main Container --- */
    .container {
        width: 100%;
        max-width: 550px;
        margin: 0 auto;
        padding: 0 20px;
    }

    .card {
        background: var(--card-bg);
        border-radius: 20px;
        padding: 30px;
        box-shadow: var(--shadow);
        text-align: center;
        margin-bottom: 25px;
        border: 1px solid #fff;
    }

    h2 {
        font-size: 1.5rem;
        font-weight: 600;
        margin-bottom: 25px;
        background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    /* --- Form Elements --- */
    .input-group {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 15px;
    }

    label {
        display: block;
        text-align: left;
        font-size: 0.85rem;
        color: var(--text-muted);
        margin-bottom: 5px;
        margin-left: 5px;
    }

    input[type="number"], input[type="file"] {
        width: 100%;
        padding: 12px 15px;
        border-radius: 12px;
        border: 2px solid var(--border);
        background: #f8fafc;
        font-size: 0.95rem;
        font-family: inherit;
        color: var(--text-main);
        transition: all 0.2s;
        outline: none;
    }

    input[type="number"]:focus {
        border-color: var(--primary);
        background: #fff;
        box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
    }

    /* Custom File Input Styling */
    .file-upload-wrapper {
        position: relative;
        margin-bottom: 20px;
    }
    
    input[type="file"] {
        padding: 10px;
        background: #fff;
        cursor: pointer;
    }
    input[type="file"]::file-selector-button {
        background-color: var(--bg-color);
        color: var(--text-main);
        border: 1px solid var(--border);
        padding: 5px 10px;
        border-radius: 6px;
        margin-right: 10px;
        font-weight: 500;
        transition: 0.2s;
    }
    input[type="file"]::file-selector-button:hover {
        background-color: var(--border);
    }

    /* --- Buttons --- */
    button, .nice-btn {
        width: 100%;
        padding: 14px;
        border-radius: 12px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        border: none;
        transition: transform 0.2s, box-shadow 0.2s;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    button:active, .nice-btn:active {
        transform: scale(0.98);
    }

    #generate {
        background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
        color: white;
        box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
    }

    #convertBtn {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%); /* Emerald */
        color: white;
        box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
        margin-top: 20px;
    }

    .nice-btn {
        margin-top: 15px;
        background: #fff;
        color: var(--text-main);
        border: 2px solid var(--border);
        text-decoration: none;
        font-size: 0.9rem;
    }
    
    .nice-btn:hover {
        border-color: var(--primary);
        color: var(--primary);
        background: #fdfdfd;
        transform: translateY(-2px);
    }

    /* --- Preview Area --- */
    .preview-wrapper {
        width: 100%;
        overflow: auto;
        margin-top: 25px;
        display: flex;
        justify-content: center;
        padding: 10px;
        border-radius: 12px;
        background: #f1f5f9;
        border: 1px dashed var(--border);
    }

    #previewBox {
        border: 2px solid var(--text-main);
        overflow: hidden;
        position: relative;
        display: none;
        /* Checkered background for transparency */
        background-image: linear-gradient(45deg, #ccc 25%, transparent 25%), linear-gradient(-45deg, #ccc 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #ccc 75%), linear-gradient(-45deg, transparent 75%, #ccc 75%);
        background-size: 20px 20px;
        background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
        background-color: #fff; 
        flex-shrink: 0;
        box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1);
        touch-action: none;
    }

    #previewImg {
        position: absolute;
        top: 0; 
        left: 0;
        cursor: grab; 
        transform-origin: top left;
        max-width: none;
    }
    
    #previewImg:active {
        cursor: grabbing;
    }

    /* --- Control Panel (Zoom & Joystick) --- */
    .control-panel {
        background: #f8fafc;
        padding: 15px;
        border-radius: 15px;
        margin-top: 20px;
        border: 1px solid var(--border);
        display: none; /* Toggled by JS */
        flex-direction: column;
        gap: 15px;
    }

    .zoomBtns {
        display: flex;
        gap: 10px;
    }

    .zoomBtns button {
        background: #fff;
        color: var(--text-main);
        border: 1px solid var(--border);
        font-size: 0.9rem;
        padding: 10px;
    }
    
    .zoomBtns button:hover {
        background: var(--border);
    }

    /* D-Pad Style Joystick */
    .joystick {
        width: 140px;
        height: 140px;
        margin: 0 auto;
        background: #fff;
        border-radius: 50%;
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        grid-template-rows: 1fr 1fr 1fr;
        gap: 5px;
        padding: 10px;
        box-shadow: inset 0 2px 5px rgba(0,0,0,0.05), 0 5px 15px rgba(0,0,0,0.05);
        border: 1px solid var(--border);
        align-items: center;
        justify-items: center;
    }

    .joybtn {
        width: 35px;
        height: 35px;
        background: var(--text-main);
        color: #fff;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 3px 0 #000;
        transition: all 0.1s;
    }
    
    .joybtn:active {
        transform: translateY(3px);
        box-shadow: 0 0 0 #000;
    }

    /* Grid positioning */
    #up { grid-column: 2; grid-row: 1; border-radius: 8px 8px 4px 4px; }
    #left { grid-column: 1; grid-row: 2; border-radius: 8px 4px 4px 8px; }
    #right { grid-column: 3; grid-row: 2; border-radius: 4px 8px 8px 4px; }
    #down { grid-column: 2; grid-row: 3; border-radius: 4px 4px 8px 8px; }

    /* --- Output Box --- */
    #outputBox {
        margin-top: 25px;
        display: none;
        background: #ecfdf5; /* Light green bg */
        padding: 20px;
        border-radius: 15px;
        border: 1px solid #a7f3d0;
        animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    #outputBox h4 {
        color: #065f46;
        margin-bottom: 10px;
    }

    #downloadBtn {
        background: #f97316; /* Orange */
        color: #fff;
        margin-top: 15px;
        box-shadow: 0 4px 15px rgba(249, 115, 22, 0.3);
    }

    /* --- Footer --- */
    footer {
        margin-top: 40px;
        text-align: center;
        color: var(--text-muted);
        font-size: 0.85rem;
    }

    footer img {
        margin-top: 15px;
        max-width: 100%;
        border-radius: 12px;
        opacity: 0.8;
        transition: opacity 0.3s;
    }
    
    footer img:hover {
        opacity: 1;
    }

    /* Mobile Tweaks */
    @media (max-width: 480px) {
        .card { padding: 20px; }
        h2 { font-size: 1.3rem; }
        .input-group { grid-template-columns: 1fr; gap: 10px; }
    }
</style>
</head>
<body>

<header>      
    <div class="brand">
        <a href="/" title="Mahin">
            <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEixjYheoQWtMj5aR7uUcKdyR7N2zceniFB1QkZ6zo_xIbUdS7F4Xf4v7PQUoOtkicXIUMS-kaE71W2VkYeeefas9b-Ww-dHV0UhMi3mF40THgHcO1ohPVL0IjbThvcruOGo0UcS_FE63hF2ggml4cLwsMkaWabC5jLzR7NUF_uK5Xtpe8RDZEAJEsAzQqc/s1600/IMG_1617.jpeg" alt="Mahin Logo">
            <span>Photo Resizer</span>
        </a>
    </div>
</header>      

<div class="container">

    <div class="card">
        <h2>Admissions Photo Tool</h2>
        <p style="font-size: 0.9rem; color: #64748b; margin-bottom: 20px;">Resize, crop and compress your photo to exact admission requirements.</p>

        <div class="file-upload-wrapper">
            <label>1. Upload Photo</label>
            <input type="file" id="upload" accept="image/*">
        </div>

        <div class="input-group">
            <div>
                <label>Width (px)</label>
                <input type="number" id="w" value="300">
            </div>
            <div>
                <label>Height (px)</label>
                <input type="number" id="h" value="300">
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
             <label>Max File Size (KB)</label>
             <input type="number" id="targetSize" value="100">
        </div>

        <button id="generate"><i class="bi bi-image"></i> Load & Preview</button>

        <div class="preview-wrapper">
            <div id="previewBox">
                <img id="previewImg">
            </div>
        </div>

        <div class="control-panel" id="controlsPanel">
            <div style="text-align: center; font-size: 0.8rem; color: #64748b; margin-bottom: 5px;">Fine Tune Position</div>
            
            <div class="joystick" id="joySection">
                <button class="joybtn" id="up"><i class="bi bi-caret-up-fill"></i></button>
                <button class="joybtn" id="left"><i class="bi bi-caret-left-fill"></i></button>
                <button class="joybtn" id="right"><i class="bi bi-caret-right-fill"></i></button>
                <button class="joybtn" id="down"><i class="bi bi-caret-down-fill"></i></button>
            </div>

            <div class="zoomBtns" id="zoomSection">
                <button id="zoomOut"><i class="bi bi-dash-lg"></i> Zoom Out</button>
                <button id="zoomIn"><i class="bi bi-plus-lg"></i> Zoom In</button>
            </div>
        </div>

        <button id="convertBtn" style="display:none;"><i class="bi bi-check-lg"></i> Crop & Download</button>

        <div id="outputBox">
            <h4><i class="bi bi-check-circle-fill"></i> Success!</h4>
            <img id="finalImg" style="width:100%; max-width:200px; border-radius:8px; margin:10px auto; border:4px solid #fff; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            <button id="downloadBtn"><i class="bi bi-download"></i> Save Image</button>
        </div>
    </div>

    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <a href="https://imgresize.maahin.my.id/sign" class="nice-btn" target="_blank">
            <i class="bi bi-pen-fill" style="color:var(--primary);"></i> Signature Resizer
        </a>
        <a href="https://imgresize.maahin.my.id/scan" class="nice-btn" target="_blank">
            <i class="bi bi-qr-code-scan" style="color:var(--secondary);"></i> Scan Tool
        </a>
    </div>

</div>

<footer>
    <div>Â© 2025 Photo Resizer - MAHIN</div>
    <div style="max-width: 400px; margin: 0 auto;">
        <img src="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgtRhoQ7YfuMkjSs0BQJrKGUTzHxB5NHEMaIxon_2Tt8DJe0zV0An7HrojiNUhSucBGPXJPJuMcbLvD8sqTqY3XTfqgDr3YuEE3bxf4EwdWLKXYePgjH8aXwGSp3Jgy_B9tjTnqqtnxwXKFEs6rMIXUxuFchIWRhwMaVkqaOlmarQEVVpZoWpvABhYQhXcx/s1600/Yellow%20coming%20soon%20Instagram%20post_20251219_113831_0000.png" alt="Coming Soon">
    </div>
</footer>       
    
<script>
let img = document.getElementById("previewImg");
let box = document.getElementById("previewBox");
let upload = document.getElementById("upload");
let zoomLevel = 1;
let pos = { x:0, y:0, drag:false, startX:0, startY:0 };
let uploadedFile = null;

/* Upload */
upload.onchange = e => {
    uploadedFile = e.target.files[0];
};

/* Generate Preview */
document.getElementById("generate").onclick = () => {
    if(!uploadedFile) return alert("Please upload an image first!");

    let w = parseInt(document.getElementById("w").value);
    let h = parseInt(document.getElementById("h").value);

    // Set box size
    box.style.width = w + "px";
    box.style.height = h + "px";

    img.src = URL.createObjectURL(uploadedFile);
    
    // Reset positions
    zoomLevel = 1;
    pos.x = 0; pos.y = 0;
    img.style.transform = "scale(1)";
    img.style.top = "0px";
    img.style.left = "0px";

    box.style.display = "block";
    
    // Show new control panel container
    document.getElementById("controlsPanel").style.display = "flex";
    
    document.getElementById("convertBtn").style.display = "inline-flex"; // Adjusted for flex button
    document.getElementById("outputBox").style.display = "none";
};

/* Zoom */
document.getElementById("zoomIn").onclick = () => {
    zoomLevel += 0.1;
    img.style.transform = `scale(${zoomLevel})`;
};
document.getElementById("zoomOut").onclick = () => {
    if(zoomLevel > 0.2){
        zoomLevel -= 0.1;
        img.style.transform = `scale(${zoomLevel})`;
    }
};

/* --- Drag Logic --- */
function startDrag(e) {
    e.preventDefault(); 
    pos.drag = true;
    
    let clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
    let clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

    pos.startX = clientX - pos.x;
    pos.startY = clientY - pos.y;
    
    img.style.cursor = 'grabbing';
}

function doDrag(e) {
    if(pos.drag){
        e.preventDefault(); 
        
        let clientX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
        let clientY = e.type.includes('touch') ? e.touches[0].clientY : e.clientY;

        pos.x = clientX - pos.startX;
        pos.y = clientY - pos.startY;
        
        img.style.left = pos.x + "px";
        img.style.top = pos.y + "px";
    }
}

function endDrag() {
    pos.drag = false;
    img.style.cursor = 'grab';
}

img.addEventListener('mousedown', startDrag);
document.addEventListener('mousemove', doDrag);
document.addEventListener('mouseup', endDrag);

img.addEventListener('touchstart', startDrag, {passive: false});
document.addEventListener('touchmove', doDrag, {passive: false});
document.addEventListener('touchend', endDrag);


/* Joystick */
function moveImg(dx, dy){
    pos.x += dx;
    pos.y += dy;
    img.style.left = pos.x + "px";
    img.style.top = pos.y + "px";
}
document.getElementById("up").onclick = ()=> moveImg(0, -10);
document.getElementById("down").onclick = ()=> moveImg(0, 10);
document.getElementById("left").onclick = ()=> moveImg(-10, 0);
document.getElementById("right").onclick = ()=> moveImg(10, 0);

/* Convert */
document.getElementById("convertBtn").onclick = () => {
    let w = parseInt(document.getElementById("w").value);
    let h = parseInt(document.getElementById("h").value);
    let targetKB = parseInt(document.getElementById("targetSize").value);

    let canvas = document.createElement("canvas");
    let ctx = canvas.getContext("2d");
    canvas.width = w;
    canvas.height = h;

    ctx.fillStyle = "#fff";
    ctx.fillRect(0, 0, w, h);

    let rect = box.getBoundingClientRect();
    let imgRect = img.getBoundingClientRect();

    let scale = zoomLevel; 

    let sx = (rect.left - imgRect.left) / scale;
    let sy = (rect.top - imgRect.top) / scale;
    let sw = rect.width / scale;
    let sh = rect.height / scale;

    ctx.drawImage(img, sx, sy, sw, sh, 0, 0, w, h);

    let quality = 0.9;
    let result;

    do {
        result = canvas.toDataURL("image/jpeg", quality);
        quality -= 0.05;
    } while(result.length/1024 > targetKB && quality > 0.1);

    document.getElementById("finalImg").src = result;
    document.getElementById("outputBox").style.display = "block";
    
    document.getElementById("outputBox").scrollIntoView({behavior: "smooth"});

    document.getElementById("downloadBtn").onclick = () => {
        let a = document.createElement("a");
        a.href = result;
        a.download = "resized_by_mahin.jpg";
        a.click();
    };
};
</script>

</body>
</html>
